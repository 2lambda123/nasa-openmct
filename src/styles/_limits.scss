// Constants TODO: move into _constants, or theme constant files
$plotLimitDashWidthOffset: 10px;
$lineBlocker: rgba($colorPlotBg, 0.3);
$plotLimitDashWidthSeverity: 50px;
$plotLimitDashWidthCritical: $plotLimitDashWidthSeverity - $plotLimitDashWidthOffset;
$plotLimitDashWidthDistress: $plotLimitDashWidthCritical - $plotLimitDashWidthOffset;
$plotLimitDashWidthWarning: $plotLimitDashWidthDistress - $plotLimitDashWidthOffset;
$plotLimitDashWidthWatch: $plotLimitDashWidthWarning - $plotLimitDashWidthOffset;

@mixin plotLimitLine($c, $breakPerc) {
    background: $lineBlocker
                linear-gradient(
                    90deg,
                    $c $breakPerc,
                    transparent $breakPerc,
                    transparent 100%
                ) repeat-x;
}

@mixin plotLimitDirectionGradient($deg, $c) {
    background: linear-gradient(
                    $deg,
                    $c,
                    transparent
    )
}

@mixin plotLimitUpper($c) {
    $breakPerc: 80%;
    @include plotLimitLine($c: $c, $breakPerc: $breakPerc);
}

@mixin plotLimitLower($c) {
    $breakPerc: 30%;
    @include plotLimitLine($c: $c, $breakPerc: $breakPerc);
}

// Markup like this: <div class="c-plot-limit c-plot-limit--color c-plot-limit--upper c-plot-limit--severe">

.c-plot-limit-line {
    box-shadow: $lineBlocker 0 0 0 2px;
    height: 1px; // Todo: move to _constants
    z-index: 1;

    // Colors and directions
    &--purple.c-plot-limit-line--upper { @include plotLimitUpper($colorLimitPurpleIc); }
    &--purple.c-plot-limit-line--lower { @include plotLimitLower($colorLimitPurpleIc); }
    &--red.c-plot-limit-line--upper { @include plotLimitUpper($colorLimitRedIc); }
    &--red.c-plot-limit-line--lower { @include plotLimitLower($colorLimitRedIc); }
    &--orange.c-plot-limit-line--upper { @include plotLimitUpper($colorLimitOrangeIc); }
    &--orange.c-plot-limit-line--lower { @include plotLimitLower($colorLimitOrangeIc); }
    &--yellow.c-plot-limit-line--upper { @include plotLimitUpper($colorLimitYellowIc); }
    &--yellow.c-plot-limit-line--lower { @include plotLimitLower($colorLimitYellowIc); }
    &--cyan.c-plot-limit-line--upper { @include plotLimitUpper($colorLimitCyanIc); }
    &--cyan.c-plot-limit-line--lower { @include plotLimitLower($colorLimitCyanIc); }

    // Severities
    &--severe { background-size: $plotLimitDashWidthSeverity 100% !important; }
    &--critical { background-size: $plotLimitDashWidthCritical 100% !important; }
    &--distress { background-size: $plotLimitDashWidthDistress 100% !important; }
    &--warning { background-size: $plotLimitDashWidthWarning 100% !important; }
    &--watch { background-size: $plotLimitDashWidthWatch 100% !important; }
}

.c-plot-limit-label {
    // Holds both label and directional gradient
    display: flex;
    width: 100%;
    z-index: 0;

    // Todo:
    &:before {
        // Direction gradient
        // TODO: change direction and transform for lower limit
        @include plotLimitDirectionGradient($deg: 0deg, $c: deeppink);
        content: "";
        display: block;
        position: absolute;
        left: 0; right: 0;
        height: 100%;
        opacity: 0.4;
        transform: translateY(-100%);
    }

    &__label {
        background: deeppink;
        border-top-right-radius: $controlCr;
        display: flex;
        flex: 0 0 auto;
        align-items: center;
        padding: 2px 6px;
        transform: translateY(-100%);
        > * + * { margin-left: 5px; }
    }
}